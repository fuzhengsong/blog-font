{"version":3,"sources":["webpack:///src/views/userViews/userArticleCreate/index.vue","webpack:///./src/views/userViews/userArticleCreate/index.vue?d028","webpack:///./src/views/userViews/userArticleCreate/index.vue"],"names":["userArticleCreate","name","data","oldTags","form","title","tags","content","status","rules","required","message","trigger","min","max","type","created","_this","this","$route","query","id","$store","dispatch","then","Object","lodash","detail","computed","extends_default","vuex_esm","methods","imgAdd","pos","$file","_this2","model","execute","file","response","url","replace","$refs","md","$img2Url","imgDel","createArticle","submitForm","save","_this3","article","validate","valid","postData","__id","addTags","deleteTags","$message","success","$router","push","userViews_userArticleCreate","render","_vm","_h","$createElement","_c","_self","directives","rawName","value","expression","staticClass","attrs","element-loading-text","ref","label-width","label","prop","callback","$$v","$set","_v","multiple","placeholder","_l","item","key","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/5.4c617142bacaef38b9a2.js","sourcesContent":["<template>\n  <section class=\"user-article-create\" v-loading=\"detail.loading\" element-loading-text=\"加载中...\">\n    <el-form :model=\"form\" :rules=\"rules\" ref=\"article\" label-width=\"120px\" >\n      <el-form-item label=\"文章标题\" prop=\"title\">\n        <el-input v-model=\"form.title\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"文章标签\" prop=\"tags\">\n        <el-select v-model=\"form.tags\" multiple placeholder=\"请选择\">\n          <el-option\n            v-for=\"item in tags.list\"\n            :key=\"item.name\"\n            :label=\"item.name\"\n            :value=\"item.name\">\n          </el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"文章内容\" prop=\"content\">\n        <mavon-editor v-model=\"form.content\"\n                      ref='md'\n                      @imgAdd=\"imgAdd\"\n                      @imgDel=\"imgDel\"\n        ></mavon-editor>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"createArticle\">发布</el-button>\n        <el-button @click=\"save\">保存</el-button>\n      </el-form-item>\n    </el-form>\n  </section>\n</template>\n\n<script>\n  import {\n    UserCreateArticleModel,\n    CommonUploadModel\n  } from '../../../model/index';\n  import {\n    mapGetters\n  } from 'vuex'\n  import {\n    extend,\n    difference\n  } from 'lodash';\n\n  export default {\n    name: \"index\",\n    data(){\n      return {\n        oldTags: [],\n        form: {\n          title: '',\n          tags: [],\n          content: '',\n          status: ''\n        },\n\n        rules: {\n          title: [\n            {required: true, message: '请输入标题', trigger: 'blur'},\n            {min: 1, max: 50, message: '长度在1-50个字符', trigger: 'blur'}\n          ],\n\n          tags: [\n            {type: 'array', required: true, message: '请选择一个标签', trigger: 'change'}\n          ],\n\n          content: [\n            {required: true, message: '请输入文章内容', trigger: 'blur'}\n          ]\n        },\n      }\n    },\n\n\n    created(){\n      if(this.$route.query && this.$route.query.id){\n        this.$store.dispatch('actionGetArticleDetail', this.$route.query.id).then(data=>{\n          this.form = extend({}, this.form, data.detail);\n          this.oldTags = data.detail.tags;\n        });\n      }\n      this.$store.dispatch('actionGetArticleTags');\n    },\n\n    computed: {\n      ...mapGetters({\n        detail: 'getArticleDetail',\n        tags: 'getTagsList'\n      })\n    },\n\n    methods: {\n      imgAdd(pos, $file){\n        CommonUploadModel.execute({\n          file: $file\n        }).then(response =>{\n          let url = response.data.url;\n          if(process.env.NODE_ENV === 'production'){\n            url = url.replace(/(\\/uploads)/, '/api' + '$1')\n          }\n          let vm = this.$refs.md;\n          vm.$img2Url(pos, url);\n        })\n      },\n\n      imgDel(){\n\n      },\n\n      createArticle(){\n        this.form.status = 'publish';\n        this.submitForm();\n      },\n\n      save(){\n        this.form.status = 'draft';\n        this.submitForm();\n\n      },\n      submitForm(){\n        this.$refs.article.validate(valid =>{\n          if(valid){\n            let postData = this.form;\n            if(this.__id || this.$route.query.id){\n              postData.id = this.__id || this.$route.query.id;\n              let addTags = difference(this.form.tags, this.oldTags);\n              let deleteTags = difference(this.oldTags, this.form.tags);\n              postData = extend({}, postData, {\n                addTags,\n                deleteTags\n              })\n            }\n            UserCreateArticleModel.execute(postData).then(response=>{\n              if(this.form.status === 'draft'){\n                this.$message.success(\"保存成功\");\n                this.__id = response.data.id\n              } else if(this.form.status === 'publish'){\n                this.$message.success(\"发布成功\");\n                this.$router.push({name: 'user_article_list'})\n              }\n\n            })\n          } else {\n\n          }\n        })\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\">\n\n  .user-article-create{\n    padding: 20px 40px;\n\n    .el-select{\n      width: 400px;\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/userViews/userArticleCreate/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.detail.loading),expression:\"detail.loading\"}],staticClass:\"user-article-create\",attrs:{\"element-loading-text\":\"加载中...\"}},[_c('el-form',{ref:\"article\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"120px\"}},[_c('el-form-item',{attrs:{\"label\":\"文章标题\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"文章标签\",\"prop\":\"tags\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"placeholder\":\"请选择\"},model:{value:(_vm.form.tags),callback:function ($$v) {_vm.$set(_vm.form, \"tags\", $$v)},expression:\"form.tags\"}},_vm._l((_vm.tags.list),function(item){return _c('el-option',{key:item.name,attrs:{\"label\":item.name,\"value\":item.name}})}),1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"文章内容\",\"prop\":\"content\"}},[_c('mavon-editor',{ref:\"md\",on:{\"imgAdd\":_vm.imgAdd,\"imgDel\":_vm.imgDel},model:{value:(_vm.form.content),callback:function ($$v) {_vm.$set(_vm.form, \"content\", $$v)},expression:\"form.content\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.createArticle}},[_vm._v(\"发布\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":_vm.save}},[_vm._v(\"保存\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-7c2e7b4e\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/userViews/userArticleCreate/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7c2e7b4e\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7c2e7b4e\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/userViews/userArticleCreate/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}